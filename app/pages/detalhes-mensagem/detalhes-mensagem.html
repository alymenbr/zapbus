<!--
  Generated template for the DetalhesMensagemPage page.

  See http://ionicframework.com/docs/v2/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-navbar *navbar>
  <ion-title>Detalhes da Mensagem</ion-title>
</ion-navbar>


<!-- TODO: Imagem de fundo do Streetview:
  http://stackoverflow.com/questions/30870083/nearest-street-view-photo-to-coordinates
-->
<ion-content padding class="detalhes-mensagem">

  <ion-card>
    <ion-item>
      <ion-badge secondary item-left>{{msg.linhaOnibus}}</ion-badge>
    </ion-item>

    <ion-item text-wrap>
      <ion-avatar item-left>
        <img src={{msg.avatarUrl}}>
      </ion-avatar>
      <h4>{{msg.detail}}</h4>
      <p>Deixado por <em primary>{{msg.authorName}}</em> em {{msg.date | date:'yMMMddHHmm' }}</p>
    </ion-item>

    <img src={{msg.mapUrl}}/>

    <ion-row no-padding>
       <ion-col>
         <button medium primary (click)='approveMessage()'>
           <ion-icon name='thumbs-up'></ion-icon>
           Aprovar
         </button>
       </ion-col>
       <ion-col text-right>
         <button medium danger (click)='reproveMessage()'>
           <ion-icon name='thumbs-down'></ion-icon>
           Reprovar
         </button>
       </ion-col>
     </ion-row>

     <ion-item>
         <button primary clear item-left>
           <ion-icon name="thumbs-up"></ion-icon>
           <div>{{msg.approvals}}</div>
         </button>
         <button danger clear item-left>
           <ion-icon name="thumbs-down"></ion-icon>
           <div>{{msg.reprovals}}</div>
         </button>
         <ion-note item-right>
           {{msg.points}} {{msg.points == 1? 'ponto': 'pontos'}}
         </ion-note>
       </ion-item>

  </ion-card>

  <ion-card>
    <ion-list>

      <ion-list-header>
      <h2 primary>Comentários:</h2>
      </ion-list-header>

      <ion-item text-wrap *ngFor="#comment of msg.comments">
        <ion-avatar item-left>
          <img src={{comment.avatarUrl}}>
        </ion-avatar>
        <h3>{{comment.detail}}</h3>
        <p>por <em primary>{{comment.author}}</em> em {{comment.date | date:'yMMMddHHmm' }}</p>
      </ion-item>

      <ion-item>
        <ion-input placeholder='Escreva seu comentário aqui' [(ngModel)]="novoComentario" type="text"></ion-input>
        <button secondary item-right (click)='sendComment()'>Enviar</button>
      </ion-item>


    </ion-list>
  </ion-card>

</ion-content>
